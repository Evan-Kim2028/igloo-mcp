{"TABLE_CATALOG": "DEFI_SAMPLE_DB", "TABLE_SCHEMA": "PROCESSED", "TABLE_NAME": "DEX_TRADES_STABLE", "TABLE_OWNER": "SECURITYADMIN", "TABLE_TYPE": "BASE TABLE", "IS_TRANSIENT": "NO", "CLUSTERING_KEY": "LINEAR(timestamp_ms, protocol)", "ROW_COUNT": 224465587, "BYTES": 16722214400, "RETENTION_TIME": 1, "SELF_REFERENCING_COLUMN_NAME": null, "REFERENCE_GENERATION": null, "USER_DEFINED_TYPE_CATALOG": null, "USER_DEFINED_TYPE_SCHEMA": null, "USER_DEFINED_TYPE_NAME": null, "IS_INSERTABLE_INTO": "YES", "IS_TYPED": "YES", "COMMIT_ACTION": null, "CREATED": "2025-03-11T07:41:00.621000-07:00", "LAST_ALTERED": "2025-09-12T22:09:57.263000-07:00", "LAST_DDL": "2025-03-11T11:40:42.677000-07:00", "LAST_DDL_BY": "DATA_ENGINEER", "AUTO_CLUSTERING_ON": "YES", "COMMENT": "Contains all dex swaps with coin metadata from multiple DEX protocols - aftermath, bluefin, bluemove, cetus, flowx, metastable", "IS_TEMPORARY": "NO", "IS_ICEBERG": "NO", "IS_DYNAMIC": "NO", "IS_IMMUTABLE": "NO", "IS_HYBRID": "NO", "DATABASE_NAME": "DEFI_SAMPLE_DB", "tags": {"DATA_OWNER": "defi_team", "PROJECT": "trading_analytics", "SUB_PROJECT": "dex_trades"}, "ddl": "CREATE OR REPLACE TABLE DEFI_SAMPLE_DB.PROCESSED.DEX_TRADES_STABLE CLUSTER BY (timestamp_ms, protocol) (\n\tPROTOCOL VARCHAR(16777216) COMMENT 'DEX protocol name',\n\tTIMESTAMP_MS NUMBER(38,0) COMMENT 'The number of milliseconds that the PTB was executed.',\n\tTRANSACTION_DIGEST VARCHAR(16777216) COMMENT 'Unique identifier for each PTB, represented as a string.',\n\tEVENT_INDEX NUMBER(38,0) COMMENT 'Holds data representing unique positional identifiers for specific events within a PTB. Currently is buggy',\n\tEPOCH NUMBER(38,0) COMMENT 'An epoch refers to a fixed time period during which the network operates under a specific set of conditions, such as validator configurations, staking rewards, and gas fees. Each epoch typically lasts 24 hours, after which the network transitions to a new epoch, allowing for updates like validator rotations or protocol adjustments. It''s a mechanism to organize network governance and operations in a decentralized system.',\n\tCHECKPOINT NUMBER(38,0) COMMENT 'A checkpoint is a periodic snapshot of the network''s state that validators agree upon to ensure consistency and finality of transactions. It acts as a reference point, summarizing a batch of processed PTBs and their effects on the ledger.',\n\tPOOL_ID VARCHAR(16777216) COMMENT 'Unique object address for a specific trading pool.',\n\tSENDER VARCHAR(16777216) COMMENT 'Cryptographic hash values representing the sender''s SUI address.',\n\tCOIN_IN VARCHAR(16777216) COMMENT 'Coin type for which coin is getting swapped into the pool',\n\tCOIN_OUT VARCHAR(16777216) COMMENT 'Coin type for which coins is getting swapped out of the pool.',\n\tAMOUNT_IN NUMBER(38,0) COMMENT 'Raw coin amount for amount of coins that get swapped into the pool',\n\tAMOUNT_OUT NUMBER(38,0) COMMENT 'Raw coin amount for amount of coins that get swapped out of the pool',\n\tA_TO_B BOOLEAN COMMENT 'Directional relationship between the pool swaps. Boolean identifies whether the swap direction goes from Token A -> Token B or from Token B -> Token A.',\n\tFEE_AMOUNT NUMBER(38,0) COMMENT 'Monetary value representing various fees associated with a trade.',\n\tCOIN_IN_NAME VARCHAR(16777216) COMMENT 'coin in token name',\n\tCOIN_IN_SYMBOL VARCHAR(16777216) COMMENT 'coin in token symbol',\n\tCOIN_IN_DECIMALS NUMBER(38,0) COMMENT 'coin in decimals',\n\tCOIN_OUT_NAME VARCHAR(16777216) COMMENT 'coin out token name',\n\tCOIN_OUT_SYMBOL VARCHAR(16777216) COMMENT 'coin out token symbol',\n\tCOIN_OUT_DECIMALS NUMBER(38,0) COMMENT 'coin out decimals',\n\tADJUSTED_AMOUNT_IN FLOAT COMMENT 'coin in swapped amount divided by decimals',\n\tADJUSTED_AMOUNT_OUT FLOAT COMMENT 'coin out swapped amount divided by decimals'\n) WITH TAG (DATA_OWNER='defi_team', PROJECT='trading_analytics', SUB_PROJECT='dex_trades') COMMENT='Contains all dex swaps with coin metadata from multiple DEX protocols - aftermath, bluefin, bluemove, cetus, flowx, metastable'"}
{"TABLE_CATALOG": "DEFI_SAMPLE_DB", "TABLE_SCHEMA": "PROCESSED", "TABLE_NAME": "COIN_INFO", "TABLE_TYPE": "DYNAMIC TABLE", "TARGET_LAG": "1 hour", "REFRESH_MODE": "INCREMENTAL", "WAREHOUSE": "COMPUTE_WH", "COMMENT": "Dynamic table containing cryptocurrency metadata, refreshes hourly from object changes", "CREATED": "2025-03-11T07:41:00.621000-07:00", "LAST_ALTERED": "2025-09-12T22:09:57.263000-07:00", "DATABASE_NAME": "DEFI_SAMPLE_DB", "ddl": "CREATE OR REPLACE DYNAMIC TABLE DEFI_SAMPLE_DB.PROCESSED.COIN_INFO(\n\tTYPE,\n\tCOIN_TYPE,\n\tCOIN_DECIMALS,\n\tCOIN_NAME,\n\tCOIN_SYMBOL\n) TARGET_LAG = '1 hour' REFRESH_MODE = INCREMENTAL INITIALIZE = ON_CREATE WAREHOUSE = COMPUTE_WH AS\nSELECT\n    type,\n    split_part(split_part(type, '<', 2), '>', 1) AS coin_type,\n    object_json:decimals::INTEGER AS coin_decimals,\n    object_json:name::STRING AS coin_name,\n    object_json:symbol::STRING AS coin_symbol\nFROM DEFI_SAMPLE_DB.RAW.OBJECT_CHANGES\nWHERE type LIKE '0x2::coin::CoinMetadata%' AND object_json:decimals IS NOT NULL\nQUALIFY RANK() OVER (PARTITION BY type ORDER BY version DESC) = 1"}
{"TABLE_CATALOG": "DEFI_SAMPLE_DB", "TABLE_SCHEMA": "ANALYTICS", "TABLE_NAME": "BTC_DEX_TRADES_USD_DT", "TABLE_TYPE": "DYNAMIC TABLE", "TARGET_LAG": "1 day", "REFRESH_MODE": "FULL", "WAREHOUSE": "COMPUTE_WH", "COMMENT": "BTC-focused trading data with USD pricing - refreshes daily", "CREATED": "2025-03-11T07:41:00.621000-07:00", "LAST_ALTERED": "2025-09-12T22:09:57.263000-07:00", "DATABASE_NAME": "DEFI_SAMPLE_DB", "ddl": "CREATE OR REPLACE DYNAMIC TABLE DEFI_SAMPLE_DB.ANALYTICS.BTC_DEX_TRADES_USD_DT(\n\tPROTOCOL,\n\tTIMESTAMP_MS,\n\tTIMESTAMP_UTC,\n\tTRANSACTION_DIGEST,\n\tPOOL_ID,\n\tPOOL_NAME,\n\tSENDER,\n\tCOIN_IN,\n\tCOIN_OUT,\n\tA_TO_B,\n\tCOIN_IN_NAME,\n\tCOIN_IN_SYMBOL,\n\tCOIN_OUT_NAME,\n\tCOIN_OUT_SYMBOL,\n\tCOIN_A_AMOUNT,\n\tCOIN_B_AMOUNT,\n\tAMOUNT_IN_USD,\n\tAMOUNT_OUT_USD,\n\tCOIN_A_VALUE_USD,\n\tCOIN_B_VALUE_USD,\n\tAVG_TRADE_VALUE_USD,\n\tCOIN_IN_PRICE_USD,\n\tCOIN_OUT_PRICE_USD\n) TARGET_LAG = '1 day' REFRESH_MODE = FULL INITIALIZE = ON_CREATE WAREHOUSE = COMPUTE_WH AS [Complex CTE with BTC pool filtering and USD pricing calculations]"}
{"TABLE_CATALOG": "DEFI_SAMPLE_DB", "TABLE_SCHEMA": "ANALYTICS", "TABLE_NAME": "FILTERED_DEX_TRADES_VIEW", "TABLE_TYPE": "VIEW", "COMMENT": "A filtered view of dex_trades_stable, containing only the entry-point trade of a swap. A trade is included if its input coin (coin_in) is present in the object state changes for that transaction, indicating it was directly sourced from the user's wallet.", "CREATED": "2025-03-11T07:41:00.621000-07:00", "LAST_ALTERED": "2025-09-12T22:09:57.263000-07:00", "DATABASE_NAME": "DEFI_SAMPLE_DB", "ddl": "CREATE OR REPLACE VIEW DEFI_SAMPLE_DB.ANALYTICS.FILTERED_DEX_TRADES_VIEW AS\nWITH TransactionUserCoins AS (\n    SELECT DISTINCT\n        previous_transaction AS transaction_digest,\n        CASE \n            WHEN coin_type = '0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI' \n            THEN '0x2::sui::SUI'\n            ELSE coin_type\n        END AS coin_type\n    FROM DEFI_SAMPLE_DB.RAW.OBJECT_CHANGES\n    WHERE coin_type IS NOT NULL AND previous_transaction IS NOT NULL\n)\nSELECT dts.*\nFROM DEFI_SAMPLE_DB.PROCESSED.DEX_TRADES_STABLE dts\nWHERE EXISTS (\n    SELECT 1\n    FROM TransactionUserCoins tuc\n    WHERE tuc.transaction_digest = dts.transaction_digest\n      AND tuc.coin_type = (CASE WHEN dts.coin_in = '0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI' THEN '0x2::sui::SUI' ELSE dts.coin_in END)\n)"}
