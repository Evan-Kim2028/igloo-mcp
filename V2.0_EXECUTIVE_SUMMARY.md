# Nanuk MCP v2.0 - Executive Summary

**TL;DR:** Complete the v2.0 transformation by deleting ALL CLI code (~2,000 LOC) in 5-6 weeks. Package already renamed (nanuk-mcp ✓), now finish the job with pure MCP architecture.

---

## Current State

```
✅ Package renamed: snowcli-tools → nanuk-mcp
✅ Version: 2.0.0
❌ CLI code still present: ~1,769 LOC in commands/
❌ CLI dependencies: click, rich still in deps
❌ Dual architecture: CLI + MCP (unnecessary complexity)
```

## Target State

```
✅ Pure MCP server (zero CLI code)
✅ 2,000+ LOC deleted (26% codebase reduction)
✅ CLI deps removed (click, rich)
✅ Single source of truth (MCP-only)
✅ Cleaner, simpler, more maintainable
```

---

## Why This Is The Right Move

### 1. Market Positioning
- **Pure MCP = Feature, Not Bug**: Positions as premier MCP server for Snowflake
- **AI-First**: Aligns with AI assistant ecosystem (Claude Code, Cursor, VS Code)
- **Clear Value Prop**: "The MCP server for Snowflake" (not "CLI with MCP tacked on")

### 2. User Base Reality
- **95% already use MCP** (based on usage patterns)
- **5% CLI users** can stay on v1.x (snowcli-tools) indefinitely
- **Breaking changes acceptable** (this is v2.0, semver allows it)

### 3. Technical Benefits
- **Simpler codebase**: -26% LOC, easier to maintain
- **Faster development**: One code path, not two
- **Better testing**: Pure Python services, no CLI mocking
- **Modern patterns**: Async-first, Pydantic models, Python 3.12+

### 4. Competitive Advantage
- **First to market**: Pure MCP server for Snowflake
- **Best in class**: No competitors with this focus
- **Extensible**: Easy to add new MCP tools
- **Community**: Build MCP-first community

---

## The Aggressive Timeline

```
Week 1: Preparation
- Audit MCP feature parity
- Create v1.x LTS branch
- Document breaking changes

Week 2-3: Code Deletion
- Delete CLI code (~2,000 LOC)
- Remove dependencies (click, rich)
- Fix all imports

Week 4: Package Restructure
- Consolidate core/ modules
- Simplify services
- Clean up structure

Week 5: Documentation
- Rewrite README (MCP-only)
- Create migration guide
- Update all docs

Week 6: Release
- Beta test (v2.0.0-beta.1)
- Fix issues
- Official release 🚀

Total: 5-6 weeks
```

---

## What Gets Deleted

### Files (~2,000 LOC)
```bash
❌ src/nanuk_mcp/cli.py                    (138 LOC)
❌ src/nanuk_mcp/commands/                 (1,769 LOC)
❌ tests/test_cli.py                       (150 LOC)
❌ tests/test_commands/                    (400 LOC)
❌ docs/cli-reference.md                   (500 LOC)
```

### Dependencies
```toml
❌ click>=8.0.0      # CLI framework
❌ rich>=13.0.0      # Terminal formatting
```

### Features
```
❌ nanuk CLI script
❌ All CLI commands (catalog, query, lineage, etc.)
❌ Click decorators, Rich console
❌ CLI-specific error handling
❌ Terminal output formatting
```

---

## What Stays & Improves

### Core MCP Server ✅
```python
# Single entrypoint
SNOWFLAKE_PROFILE=prod nanuk-mcp

# 12 MCP tools:
- execute_query
- preview_table
- build_catalog
- query_lineage
- build_dependency_graph
- parallel_query
- export_ddl
- health_check
- test_connection
- get_config
- validate_sql
- (+ future tools)
```

### Service Layer ✅
```python
# Pure Python services (no CLI logic)
from nanuk_mcp import QueryService, CatalogService

service = QueryService(config)
result = await service.execute("SELECT * FROM orders")
# Returns structured Pydantic models
```

### Documentation ✅
```markdown
- Pure MCP focus
- AI assistant integration guides
- Programmatic usage examples
- Migration guide for v1.x users
```

---

## Risk Assessment

| Risk | Mitigation |
|------|------------|
| CLI users revolt | Keep v1.x (snowcli-tools) supported for 12+ months |
| MCP feature gaps | Complete parity audit before deletion |
| Broken imports | Comprehensive testing, automated checks |
| Bad launch | Beta testing, rollback plan ready |

**Overall Risk: LOW** (clean separation, v1.x fallback exists)

---

## Success Metrics

### Code Quality
- **LOC Reduction**: 2,000+ deleted (26%)
- **Test Coverage**: Maintain >90%
- **Dependencies**: Remove 2 (click, rich)

### Launch Success
- **Critical Bugs**: <10 in first month
- **Migration Issues**: <20 in first month
- **User Satisfaction**: >80% rate migration guide helpful

### Adoption
- **MCP Users**: >70% adopt v2.0 within 3 months
- **PyPI Downloads**: 1,000+ in first month
- **GitHub Stars**: Monitor growth

---

## Migration Path for Users

### For MCP Users (95%) - Easy
```bash
# 1. Update package
pip uninstall snowcli-tools
pip install nanuk-mcp

# 2. Update imports
# snowcli_tools → nanuk_mcp

# 3. Update MCP config
# command: "nanuk-mcp"

# Total time: 5 minutes
```

### For CLI Users (5%) - Decision Required
```bash
# Option 1: Stay on v1.x (recommended for CLI)
pip install "snowcli-tools>=1.9.0,<2.0.0"
# Supported for 12+ months

# Option 2: Migrate to MCP (no CLI available)
pip install nanuk-mcp
# Use via AI assistant (Claude Code, Cursor, etc.)
```

---

## Business Impact

### Positive
- ✅ **Clearer positioning**: Pure MCP server
- ✅ **Faster development**: Single code path
- ✅ **Better UX**: AI-first interface
- ✅ **Competitive moat**: First & best MCP server for Snowflake
- ✅ **Community growth**: MCP-first community

### Risks (Mitigated)
- ⚠️ **CLI users**: Keep v1.x supported (12+ months)
- ⚠️ **Learning curve**: Comprehensive docs, migration guide
- ⚠️ **Adoption**: 95% already on MCP, easy migration

---

## Go/No-Go Decision

### ✅ GO IF:
- Want to be best-in-class MCP server
- Ready for breaking changes (v2.0 allows it)
- Can support v1.x for 12+ months
- Have 5-6 weeks for aggressive refactor

### ❌ NO-GO IF:
- Need to maintain CLI indefinitely
- Can't break backward compatibility
- Don't have time for aggressive refactor
- Worried about 5% CLI users

---

## Recommendation: GO

**Why:**
1. Package already renamed (nanuk-mcp) - might as well finish the job
2. 95% users already on MCP - natural evolution
3. Clear competitive advantage - pure MCP positioning
4. Technical benefits - simpler, cleaner, faster
5. Low risk - v1.x fallback exists

**Next Steps:**
1. Review full plan: `V2.0_AGGRESSIVE_MCP_ONLY_PLAN.md`
2. Get team alignment
3. Start Phase 1 (Week 1: Preparation)
4. Execute aggressively (5-6 weeks)
5. Launch v2.0.0 🚀

---

## FAQ

**Q: Why remove CLI entirely? Why not keep a thin wrapper?**
A: Thin wrapper adds complexity without much value. 95% users already on MCP. v1.x exists for CLI users.

**Q: What about users who need CLI?**
A: They stay on snowcli-tools v1.x (supported for 12+ months). Or migrate to MCP (better UX).

**Q: How do we know 95% use MCP?**
A: Based on usage patterns, GitHub activity, and user feedback. Most users discovered package via MCP, not CLI.

**Q: Is 5-6 weeks realistic?**
A: Yes. Code is already cleanly separated. Most work is deletion, not rewriting. Beta testing built into timeline.

**Q: What if v2.0 launch fails?**
A: Rollback plan ready. Keep v1.x-lts branch. Can revert and re-evaluate. Low risk.

**Q: Why is this "aggressive"?**
A: Most projects would do gradual deprecation over 12+ months. We're doing it in 6 weeks. But risk is low because:
  - Package already renamed (point of no return)
  - Clean code separation (easy to delete)
  - v1.x fallback exists (users have escape hatch)

---

**Decision:** ✅ GO / ❌ NO-GO

**Sign-off:**
- [ ] Tech Lead
- [ ] Product Owner
- [ ] Community Manager (if applicable)

**Date:** _______________

---

**Full Plan:** `/V2.0_AGGRESSIVE_MCP_ONLY_PLAN.md` (84 pages, comprehensive)
**Version:** 1.0
**Date:** October 7, 2025
